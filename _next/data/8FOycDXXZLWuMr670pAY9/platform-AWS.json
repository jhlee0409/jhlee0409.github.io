{"pageProps":{"categories":[{"title":"blockchain","sub":[{"title":"DApp","count":1},{"title":"solidity","count":4}]},{"title":"platform","sub":[{"title":"AWS","count":2},{"title":"Google Analytics 4","count":1}]},{"title":"tech","sub":[{"title":"CS","count":1},{"title":"CSS","count":2},{"title":"Data_Structure_&_Algorithms","count":9},{"title":"HTML","count":1},{"title":"javascript","count":4},{"title":"markdown","count":1},{"title":"Next.js","count":1},{"title":"programming","count":3},{"title":"react","count":2},{"title":"refactoring","count":3},{"title":"typescript","count":2}]}],"data":[{"data":{"title":"AWS Amplify Next.js 동적 경로(Dynamic Routes) 설정하기","date":"2022-09-17","tags":["TIL","AWS","Amplify","Next.js","Dynamic Routes","동적 경로"],"draft":false,"summary":"Amplify로 배포된 Next.js 프로젝트 동적 경로 설정하기","mainCategory":"platform","subCategory":"AWS"},"content":"\n# 서론\n\n- `static`하게 생성된 `html`파일들을 `Amplify`로 배포할 시에는 `url`에 맞는 `html`파일을 보여준다.\n- 하지만 `동적`으로 설정한 경로 같은 경우 이벤트 리스너로 `Link`이동 시에는 정상 작동하지만, 새로고침하거나 직접 주소창에 `url`을 치고 들어오면 `404 에러`를 반환한다.\n- 그 이유는`static`하게 생성된 `동적 경로`로 만들어진 `html` 파일을 보면 `[id].html` 이런 형식으로 만들어져 있기 때문에 실제 주소창에 적혀있는 `url`에 맞는 `html`파일을 찾지 못하기 때문이다.\n- `Next.js`의 `SSG`를 담당하는 함수를 호출해서 생성하면 각각에 `id`에 맞게 `html`파일을 전부 만들어준다면 `동적 경로`를 따로 설정할 필요가 없다.\n- 허나 실질적으로 `id`가 수백, 수천 개에 달하는 게시물 같은 경우 모든 `html` 파일들을 만들어주는 것은 비효율적이다.\n- 그렇다면 `동적 경로`로 만들어진 `html`파일의 경우 어떤식으로 설정을 하면 될까?\n\n# 사용법\n\n## 1. Amplify 콘솔로 진입 후 설정할 프로젝트로 이동\n- 이후 `다시 쓰기 및 리디렉션`을 클릭한다.\n\n![Amplify 프로젝트 좌측 메뉴](/assets/posts/til/AWS/AWS-Amplify-Next.js-동적-경로(Dynamic-Routes)-설정하기/01.png)\n\n## 2. `다시 쓰기 및 리디렉션` 페이지로 이동\n- 여기서는 라우팅에 관련해서 설정한 목록들을 확인할 수 있다.\n- 이후 `편집`을 누른다.\n\n![다시 쓰기 및 리디렉션 페이지](/assets/posts/til/AWS/AWS-Amplify-Next.js-동적-경로(Dynamic-Routes)-설정하기/02.png)\n\n\n## 3. `다시 쓰기 및 리디렉션` 설정\n- 여기서 오늘 할 `동적 경로`를 설정할 것이다.\n- 이외에도 `200`, `301`, `302`, `404`등 다양한 `status`에 대해 설정이 가능하다.\n\n![다시 쓰기 및 리디렉션 설정 페이지](/assets/posts/til/AWS/AWS-Amplify-Next.js-동적-경로(Dynamic-Routes)-설정하기/03.png)\n\n### 설정법\n\n- `static`하게 생성된 동적 경로로 이루어진 `html`파일 이름을 `대상 주소`에 그리고 파라미터 값의 이름을 그대로 가져다가 `<>`로 바꿔준뒤 `.html`을 제거해서 `소스 주소`에 넣는다.\n- 형식은 `200`으로 설정해준다.\n- `소스 주소`가 실제로 주소창에 표기되는 형식이다.\n> e.g. `/theme/<id>`의 `소스 주소`의 경우 주소창에 표기될 때는 `/theme/primary`, `/theme/secondary`이런 식으로 매칭이 된다.\n\n| 소스 주소 | 대상 주소 | 형식 |\n| ---- | ---- | ----------- |\n| /theme/<id> | /theme/[id].html | 200(다시 쓰기) |\n| /theme/<id>/main.html | /theme/[id]/main.html | 200(다시 쓰기) |\n| /post/<categoryId>/<postId> | /post/[categorId]/[postId].html | 200(다시 쓰기) |\n\n- 위와 같은 형식으로 `다시 쓰기 및 리디렉션` 페이지에서 설정해주면 `동적경로`로 이루어진 페이지로 매칭된다.\n- 이후 `저장`버튼을 누르고 반영 메세지를 확인한 뒤 새로고침이나 직접 주소창에 입력해서 들어가도 정상적으로 `url`에 맞는 `html`을 보여주는 것을 확인할 수 있다.\n\n***\n\n### 참조\n\n- [Using redirects - AWS Amplify Hosting](https://docs.aws.amazon.com/amplify/latest/userguide/redirects.html)\n- [Amplify HostingでのNext.jsのDynamic Routesの設定](https://zenn.dev/nus3/articles/e3da1bdb3ef302962f07)\n\n***\n\n#### 피드백은 언제나 환영입니다.","path":"AWS Amplify Next.js 동적 경로(Dynamic Routes) 설정하기"},{"data":{"title":"AWS CodeBuild Webhook 이벤트 설정하기","date":"2022-09-02","tags":["TIL","AWS","CodeBuild","Webhook 이벤트"],"draft":false,"summary":"특정 레포지토리에 특정 이벤트가 일어났을 때만 자동으로 빌드 시작하기","mainCategory":"platform","subCategory":"AWS"},"content":"\n# 서론\n\n- `AWS CodeBuild`를 사용하다보면 특정 상황에서만 동작하도록 설정해야할 때가 있다.\ne.g. `master branch`에 `merge`가 되었을 때 빌드 시작\n- `AWS CodeBuild`의 간단한 설정 만으로 해당 기능을 구현할 수 있다.\n- 소스 코드의 변경을 자동적으로 감지하고 특정 상황에서만 빌드 트리거가 발생하도록 설정해보겠다.\n\n- 이미 `AWS CodeBuild`의 빌드 프로젝트가 생성되어 있다고 가정하겠다.\n- `AWS CodeBuild`의 설명과 생성 프로세스는 추후 포스팅해서 다루도록 하겠다.\n\n# 설정 프로세스\n\n## 1.  특정 빌드 프로젝트로 이동\n\n![빌드 프로젝트 설정](/assets/posts/til/AWS/AWS-CodeBuild-Webhook-이벤트-설정하기/00.png)\n\n## 2. 우측 상단 `편집` 클릭 후 `소스`클릭\n\n![편집 -> 소스 클릭](/assets/posts/til/AWS/AWS-CodeBuild-Webhook-이벤트-설정하기/01.png)\n\n\n## 3. WebHook 이벤트 활성화\n\n### 3-1 아래의 체크 박스를 클릭하면 설정 가능한 항목들이 나타난다.\n\n![Webhook 활성화](/assets/posts/til/AWS/AWS-CodeBuild-Webhook-이벤트-설정하기/02.png)\n\n\n### 3-2 우리가 이번에 설정할 항목들은 아래와 같다.\n\n1. `이벤트 유형` 설정\n2. `HEAD_REF`와 `BASE_REF` 설정\n\n![Webhook 항목 선택](/assets/posts/til/AWS/AWS-CodeBuild-Webhook-이벤트-설정하기/03.png)\n\n\n### 3-3 이벤트 유형 클릭 시 아래와 같은 4가지 선택사항이 있다. (중복 선택 가능)\n\n- `PUSH` : 해당 소스 코드의 branch 상관없이 Push가 일어나면 자동으로 빌드 시작\n- `PULL_REQUEST_CREATED` : 풀 리퀘스트가 생성되었을 때 자동으로 빌드 시작\n- `PULL_REQUEST_UPDATED` : 풀 리퀘스트가 업데이트 되었을 때 자동으로 빌드 시작\n- `PULL_REQUEST_MERGED` : 생성된 풀 리퀘스트가 병합을 완료했을 때 자동으로 빌드시작\n\n![이벤트 유형 선택](/assets/posts/til/AWS/AWS-CodeBuild-Webhook-이벤트-설정하기/04.png)\n\n### 3-4 특정 조건 생성하기\n\n- `HEAD_REF` : 출발점\n- `BASE_REF` : 도착점\n- e.g. 만약 위에서 `PULL_REQUEST_MERGED`만 선택했을 경우\n    - `dev(HEAD_REF) branch`  에서 `main(BASE_REF) branch` 로 풀 리퀘스트가 생성되고 병합이 완료되었을 때 빌드 시작\n- `BASE_REF`와 `HEAD_REF`에는 `정규식`을 입력해야하는 데 `^refs/heads/${브랜치 이름}$` 으로 입력해두면 일치하는 브랜치를 `참조`한다.\n- `BASE_REF` 의 경우 PULL 요청에서만 작동한다.\n\n![추가 조건 설정](/assets/posts/til/AWS/AWS-CodeBuild-Webhook-이벤트-설정하기/05.png)\n\n### 3-5 특정 조건 완성\n\n- 아래와 같은 조건으로 설정했다면 `dev → main` 으로 생성된 `풀 리퀘스트`가 `병합이 완료`되면 빌드를 자동으로 시작\n\n![Webhook 설정 완료](/assets/posts/til/AWS/AWS-CodeBuild-Webhook-이벤트-설정하기/06.png)\n\n### 3-6 설정 업데이트\n\n- `소스 업데이트` 클릭하면 설정 완료\n\n![업데이트 선택](/assets/posts/til/AWS/AWS-CodeBuild-Webhook-이벤트-설정하기/07.png)\n\n#\n\n### 참조\n\n[WebhookFilter](https://docs.aws.amazon.com/codebuild/latest/APIReference/API_WebhookFilter.html)\n\n#\n\n#### 피드백은 언제나 환영입니다.","path":"AWS CodeBuild Webhook 이벤트 설정하기"}]},"__N_SSG":true}